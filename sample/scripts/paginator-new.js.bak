(function($){

	var defaults = 
	{
		item: 1,
		width: '200px',
		height: '200px',
		row: 3,
		column: 3,
		margin: '5px',
		direction: 'vertical',
		selector: 'li',
		slideshow: false,
		showtime: 5000,
		controller: false,
		touch: false,
		find: false
	};
	
	var pages;
	(function(){
	
		var object;
		var settings;
		
		function initialized(query_object, options) {
		
			object = query_object;
			settings = options;
			
			// var page_elements = pageConstruction();
			var page_elements = build();
			
			return page_elements;
		};
		
		function build() {
			var items = object.children(settings.selector);
			var pages = Math.ceil( ((items.length/settings.item)*10)/10 ); // Roundup page value

			var canvas = $('<div />').addClass('page-canvas');
			
			canvas.append(
				$('<div />').addClass('page-container')
			);
			
			canvas.find('.page-container').append($('<ul />'));
			
			var count = 0;
			var page = 0;
			var wrapped_items = null;
			
			items.each(function(){
				if(count % settings.item == 0) {
					page++;
					canvas.find('ul').append(
						$('<li />').addClass('page-element page-element-'+page)
					);
					canvas.find('li.page-element-'+page).append(this);
					
				} else {
					canvas.find('li.page-element-'+page).append(this);
				}
				count++;
			});

			return canvas;
		}
		
/*
		function pageConstruction() {

			var container = $('<div />').addClass('pagination-group');
			container.addClass('viewport-container');
			container = object.children(settings.selector).wrapAll(container);
			
			var first = true;
			var count = 1;
			var wrapper = $('<div />').addClass('page');
			var wrapped_items = null;
			
			container.each(function(){
				$(this).addClass('count');
				if(count % settings.item == 0) {		
					wrapped_items = $('.count').wrapAll(wrapper);
					wrapped_items.removeClass('count');
				}
				count++;
			});
			
			wrapped_items = $('.count').wrapAll(wrapper);
			wrapped_items.removeClass('count');
			
			
			pages = Math.ceil( ((container.length/settings.item)*10)/10 ); // Roundup page value

			var pagination = $('<div />').addClass('pagination');
			pagination.append('<ul>');
			for( var page = 0; page < pages; page++) {
				var page_button = $('<li />').addClass('pager');
				pagination.find('ul').append(page_button);
			}
			object.append(pagination);

			return object;
		};
*/
		
		pages = {
			initialized: initialized
		};
		
	})();
	
	// ---- Main function ----
	$.fn.pagination = function(options)
	{
		return this.each(function(){
			
			var settings = {};
			var object = $(this).clone();
			
			$.extend(settings, defaults, options);
			
			var paginator = pages.initialized(object, options);
			
			$(this).hide();
			$(this).parent().append(paginator);
		});
	};
	// ---- End Main Function ----
	
})(jQuery)